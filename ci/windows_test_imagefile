ARG CI_IMAGE_NAME_TAG
FROM ${CI_IMAGE_NAME_TAG}

ARG CI_CCACHE_VERSION
RUN powershell -NoLogo -NoProfile -Command \
    choco feature disable -n=usePackageExitCodes ; \
    choco install --yes --no-progress ccache --version=$env:CI_CCACHE_VERSION

# RUN powershell -NoLogo -NoProfile -Command \
      Get-Command -Name "ccache"

RUN powershell -NoLogo -NoProfile -Command \
    choco feature disable -n=usePackageExitCodes ; \
    choco install --yes --no-progress python3 --version=3.9.6

RUN powershell -NoLogo -NoProfile -Command \
    [Environment]::SetEnvironmentVariable("PYTHONUTF8", "1", "Machine")


# RUN powershell -NoLogo -NoProfile -Command \
#     Get-Command -Name "python"

# RUN powershell -NoLogo -NoProfile -Command \
#     $env:PATH

# RUN powershell -NoLogo -NoProfile -Command \
#     refreshenv

# RUN powershell -NoLogo -NoProfile -Command \
#     $env:PATH

RUN powershell -NoLogo -NoProfile -Command \
    pip install zmq

# RUN powershell -NoLogo -NoProfile -Command \
#     Get-Command -Name "git"

RUN powershell -NoLogo -NoProfile -Command \
    Write-Host (Split-Path -Leaf $PWD)
